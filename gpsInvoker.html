<!DOCTYPE html>
<html>
  <head></head>

  <body>
    <form id="gpsInvoker">
      <button type="button" onclick="invokeGPSCoords()">invoke</button>
      <button type="button" id="btnTracking"  onclick="trackMe()">Tracking!</button>
      <button type="button" onclick="stopTrackingMe()">Stop tracking!</button>

      <div name="output" style="display: block; width:fit-content; height: fit-content; white-space: pre;"></div>
    </form>
    <script>
      let gpsInvoker = document.getElementById("gpsInvoker");
      let output = gpsInvoker.querySelector("div[name=output]");
      let btnTracking = document.getElementById("btnTracking");
      let trackLoop = null;

      function stopTrackingMe(){
        btnTracking.enabled = true;
        clearInterval(trackLoop);
        trackLoop=null;
      }

      function invokeGPSCoords() {
        try {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showInvokeResult,showInvokeError);
          } else {
            alert("Your browser does not support geolocation");
          }
        } catch (ex) {
          output.innerHTML = ex.message;
        }
      }

      function trackMe(){
        try {
            btnTracking.enabled = false;
            if(navigator.geolocation){
                trackLoop = setInterval(
                    ()=>navigator.geolocation.getCurrentPosition(showInvokeResult, showInvokeError),300
                );
            } else {
                alert ("Your browser does not support geolocation");
            }
        } catch(ex){
            output.innerHTML = ex.message;
        }
      }

      function showInvokeResult(pos) {
        // alert("invoke");
        let coords = pos.coords;
        output.innerHTML += `
            Altitude: ${coords.altitude}\n
            Latitude: ${coords.latitude}\n
            Longtitude: ${coords.longitude}\n
            With accuracy: ${coords.accuracy} meters\n
            ` + output.innerHTML;
        // alert(gpsInvoker.output.value);
      }

      function showInvokeError(err){
        output.innerHTML += `ERROR ${err.code}: ${err.message}` + output.innerHTML;
      }
    </script>
  </body>
</html>